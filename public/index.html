<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="style.css" />
    <title>pippor & 2tee</title>
    <link rel="icon" href="assets/icons/icon.png" type="image/png">
</head>

<body>

    <!-- Navbar -->
    <div class="nav">
        <nav>
            <div class="nav-logo"><span><a href="index.html">PTTP</a></span></div>

            <div class="nav-toggle" id="nav-toggle">
                <i class="ri-menu-line"></i>
            </div>

            <ul class="nav-links" id="nav-menu">
                <li class="link"><a href="#profile">Profile</a></li>
                <li class="link"><a href="#schedule">Schedule</a></li>
                <li class="link"><a href="#discography">Discography</a></li>
                <li class="link"><a href="#filmography">Filmography</a></li>
                <li class="link"><a href="#brand">Brand Presenter</a></li>
                <li class="link"><a href="#awards">Awards</a></li>
                <li class="link"><a href="#shows">Shows</a></li>
            </ul>
        </nav>
    </div>

    <!-- Profile Section -->
    <section class="profile-section" id="profile">
        <div class="profile-card">
            <div class="profile-image">
                <img src="https://pbs.twimg.com/media/GuB0uEoWMAAHVIT?format=jpg&name=large" alt="Por">
            </div>
            <div class="profile-text">
                <h1><span>Por</span></h1>
                <h2>Suppakarn Jirachotikul</h2>
                <p>
                    Rising actor-singer who debuted as a main member of DVI after competing on LAZiCON. Notable role as Punlee in Your Sky Series; upcoming as Qin in Duang With You Series.
                </p>
                <div class="social-links">
                    <a href="https://x.com/porsuppakarn" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.instagram.com/porsuppakarn" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.tiktok.com/@porsuppakarn" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="https://weibo.com/u/7910928995" target="_blank"><i class="fa-brands fa-weibo"></i></a>
                </div>
            </div>
        </div>

        <div class="profile-card">
            <div class="profile-image">
                <img src="https://pbs.twimg.com/media/Gt93Ot5WYAAMRKO?format=jpg&name=4096x4096" alt="TeeTee">
            </div>
            <div class="profile-text">
                <h1><span>TeeTee</span></h1>
                <h2>Wanpichit Nimitparkpoom</h2>
                <p>
                    New-generation actor recognized from DMD Friendship the Reality. Trained via TO BE NUMBER ONE IDOL. Appeared as Glaijai in Your Sky Series, with an upcoming lead as Duang in Duang With You Series.
                </p>
                <div class="social-links">
                    <a href="https://x.com/twnpich" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.instagram.com/twnpich/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.tiktok.com/@teetee.wpc" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="https://weibo.com/u/7978599852" target="_blank"><i class="fa-brands fa-weibo"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Schedule Section -->
    <section class="schedule" id="schedule">
        <div class="schedule-container">
            <h2 class="section-title">Schedule</h2>
            <div class="schedule-grid" id="scheduleGridUpcoming"></div>
            <div class="view-all">
                <a href="schedule.html">View All Events</a>
            </div>
        </div>
    </section>

    <script>
        function loadScheduleData(range, elementId) {
            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];
                const grid = document.getElementById(elementId);

                grid.innerHTML = rows.map(row => {
                    const [date, time, artist, title, location, info, img, link, outfit, keyword, tag, note, keylink, taglink, dateformat] = row;
                    return `
                        <div class="schedule-card">
                            <img src="${img}" alt="schedule" ${ link ? `onclick="openLink('${link}')"` : (info ? `onclick="openLink('${info}')"` : '')}/>
                            <div class="schedule-details">
                                ${title ? `<p class="schedule-title">${title}</p>` : ''}
                                
                                ${(keyword || tag) ? `
                                    <div class="keytag">
                                        ${keyword ? `<a href="${keylink}" class="schedule-tag" target="_blank" rel="noopener noreferrer">${keyword}</a>` : ''}
                                        ${tag ? `<a href="${taglink}" class="schedule-tag" target="_blank" rel="noopener noreferrer">${tag}</a>` : ''}
                                    </div>
                                ` : ''}
                                
                                <div class="datetimelocation">
                                    <div class="schedule-info">
                                        <i class="fa-solid fa-calendar-days"></i>
                                        <span>${date} ${time ? `| ${time}` : ''}</span>
                                    </div>
                                    ${location ? `
                                        <div class="schedule-info">
                                            <i class="fa-solid fa-location-dot"></i>
                                            <span>${location}</span>
                                        </div>
                                    ` : ''}
                                </div>

                                <div class="schedule-btn">
                                    ${
                                        link
                                            ? `<a href="${link}" target="_blank" class="streaming">Rerun</a>`
                                            : (info ? `<a href="${info}" target="_blank" class="streaming">info</a>` : '')
                                    }
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            });
        }

        loadScheduleData('upcoming!A2:Z', 'scheduleGridUpcoming');
    </script>

    <!-- Discography Section -->
    <section class="discography" id="discography">
        <div class="discography-container">
            <h2 class="section-title">Discography</h2>
            <div class="discography-grid" id="singleGrid"></div>
        </div>
    </section>

    <script>
        function createDiscographyCard(row) {
            const [artist2, date, song, artist, link, img, formatdate] = row;

            return `
            <div class="ent-card ${artist2}">
                <img src="${img}" alt="${song}" class="img-11" />
                <div class="ent-details">
                    <p class="ent-title">${song}</p>
                    <p class="ent-subtitle-1">${artist}</p>
                    <p class="ent-subtitle-2">${formatdate}</p>
                    <p class="play_btn" onclick="openLink('${link}')">
                        <i class="fa-solid fa-play"></i>
                    </p>
                </div>
            </div>
            `;
        }

        function loadDiscographyData(range) {
            const container = document.getElementById("singleGrid");
            container.innerHTML = `<div class="loading-spinner"></div>`;

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    container.innerHTML = "<p>no data</p>";
                    return;
                }

                container.innerHTML = rows.map(createDiscographyCard).join("");
            })
            .catch(err => {
                console.error(err);
                container.innerHTML = "<p>error fetch data</p>";
            });
        }

        // โหลดข้อมูลครั้งเดียว
        loadDiscographyData("discography!A2:Z");
    </script>

    <!-- Filmography Section -->
    <section class="film" id="filmography">
        <div class="film-container">
            <h2 class="section-title">Filmography</h2>
        </div>
        <div class="tab-film-menu" id="tabFilmMenu"></div>
        <div class="tab-film-contents" id="tabFilmContents"></div>
    </section>

    <script>
        function createFilmCard(row) {
            const [type, title, role, info, link, img] = row;

            return `
            <div class="ent-card">
                <img src="${img}" alt="${title}" class="img-34" />
                <div class="ent-details">
                    <p class="ent-title">${title}</p>
                    <p class="ent-subtitle-1">${role}</p>
                    <p class="ent-subtitle-2">${info}</p>
                    <p class="play_btn" onclick="openLink('${link}')"><i class="fa-solid fa-play"></i></p>
                </div>
            </div>
            `;
        }

        function loadFilmData(range) {
            const tabFilmMenu = document.getElementById("tabFilmMenu");
            const tabFilmContents = document.getElementById("tabFilmContents");

            tabFilmMenu.innerHTML = `<div class="loading-spinner"></div>`;
            tabFilmContents.innerHTML = "";

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    tabFilmContents.innerHTML = `<p>No data available</p>`;
                    tabFilmMenu.innerHTML = "";
                    return;
                }

                const types = [...new Set(rows.map(r => r[0]))]; 

                tabFilmMenu.innerHTML = types.map((type, idx) => 
                    `<span class="film-link ${idx===0?'active':''}" data-tab="${type}">${type}</span>`
                ).join("");

                tabFilmContents.innerHTML = types.map((type, idx) => {
                    const filtered = rows.filter(r => r[0] === type);
                    return `
                        <div id="${type}" class="film-content ${idx===0?'active':''}">
                            <div class="film-grid">
                                ${filtered.map(createFilmCard).join("")}
                            </div>
                        </div>`;
                }).join("");

                document.querySelectorAll(".film-link").forEach(tab => {
                    tab.addEventListener("click", () => {
                        document.querySelectorAll(".film-link").forEach(t => t.classList.remove("active"));
                        document.querySelectorAll(".film-content").forEach(c => c.classList.remove("active"));
                        tab.classList.add("active");
                        document.getElementById(tab.dataset.tab).classList.add("active");
                    });
                });
            })
            .catch(err => {
                console.error(err);
                container.innerHTML = "<p>error fetch data</p>";
            });
        }

        loadFilmData("film!A2:Z");
    </script>



    <!-- Brand Presenter Section -->
    <section class="brand" id="brand">
        <div class="brand-container">
            <h2 class="section-title">Brand Presenter</h2>
            <div class="brand-grid" id="presenterGrid"></div>
        </div>
    </section>

    <script>
        function createPresenterCard(row) {
            const [artist, date, brand, link, dmd, img] = row;

            return `
                <div class="ent-card">
                    <img src="${img}" alt="${brand}" class="img-11" />
                    <div class="ent-details">
                        <p class="ent-title">${brand}</p>
                        <p class="ent-subtitle-1">Start: ${date}</p>
                        <p class="play_btn" onclick="openLink('${dmd}')">
                            <i class="fa-solid fa-link"></i>
                        </p>
                    </div>
                </div>
            `;
        }
        function loadPresenterData(range) {
            const container = document.getElementById("presenterGrid");
            container.innerHTML = `<div class="loading-spinner"></div>`;
            
            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    container.innerHTML = "<p>no data</p>";
                    return;
                }

                container.innerHTML = rows.map(createPresenterCard).join("");
            })
            .catch(err => {
                console.error(err);
                container.innerHTML = "<p>error fetch data</p>";
            });
        }
        loadPresenterData('presenter!A2:Z');
    </script>

    <!-- Awards Section -->
    <section class="awards" id="awards">
        <div class="awards-container">
            <h2 class="section-title">Awards</h2>
            <div class="awards-grid" id="awardsGrid"></div>
        </div>
    </section>

    <script>
        function createAwardsCard(row) {
            const [artist, date, award, category, result, link, note, img] = row;

            return `
                <div class="ent-card">
                    <img src="${img}" alt="${award}" class="img-11" />
                    <div class="ent-details">
                        <p class="ent-title">${award}</p>
                        <p class="ent-subtitle-1">${category}</p>
                        <p class="ent-subtitle-2 ${result}">${result}</p>
                        <p class="play_btn" onclick="openLink('${link}')">
                        <i class="fa-solid fa-link"></i>
                    </p>
                    </div>
                </div>
            `;
        }
        function loadAwardsData(range) {
            const container = document.getElementById("awardsGrid");
            container.innerHTML = `<div class="loading-spinner"></div>`;

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    container.innerHTML = "<p>no data</p>";
                    return;
                }

                container.innerHTML = rows.map(createAwardsCard).join("");
            })
            .catch(err => {
                console.error(err);
                container.innerHTML = "<p>error fetch data</p>";
            });
        }
        loadAwardsData('awards!A2:Z');
    </script>

    <!-- Shows Section -->
    <section class="shows" id="shows">
        <div class="shows-container">
            <h2 class="section-title">Shows</h2>
        </div>

        <div class="tab-shows-menu" id="tabShowsMenu"></div>
        <div class="tab-shows-contents" id="tabShowsContents"></div>
    </section>

    <script>
        function createshowscard(row) {
            const [type, artist, date, title, link, id, thumbnail, channel, imgchannel, duration] = row;
            return `
            <div class="showscard" onclick="openLink('${link}')">
                <div class="thumbnail">
                    <img src="${thumbnail}" alt="video">
                    <span class="badge">${duration}</span>
                </div>
                <div class="info">
                    <img src="${imgchannel}" alt="channel">
                    <div class="text">
                        <p class="title">${title}</p>
                        <p class="channel">${channel} • ${date}</p>
                    </div>
                </div>
            </div>
            `;
        }

        function loadShowsData(range) {
            const tabShowsMenu = document.getElementById("tabShowsMenu");
            const tabShowsContents = document.getElementById("tabShowsContents");

            tabShowsMenu.innerHTML = `<div class="loading-spinner"></div>`;
            tabShowsContents.innerHTML = "";

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    tabShowsContents.innerHTML = `<p>No data available</p>`;
                    tabShowsMenu.innerHTML = "";
                    return;
                }

                const types = [...new Set(rows.map(r => r[0]))]; 

                tabShowsMenu.innerHTML = types.map((type, idx) => 
                    `<span class="shows-link ${idx===0?'active':''}" data-tab="${type}">${type}</span>`
                ).join("");

                tabShowsContents.innerHTML = types.map((type, idx) => {
                    const filtered = rows.filter(r => r[0] === type);
                    return `
                        <div id="${type}" class="shows-content ${idx===0?'active':''}">
                            <div class="shows-grid">
                                ${filtered.map(createshowscard).join("")}
                            </div>
                        </div>`;
                }).join("");

                document.querySelectorAll(".shows-link").forEach(tab => {
                    tab.addEventListener("click", () => {
                        document.querySelectorAll(".shows-link").forEach(t => t.classList.remove("active"));
                        document.querySelectorAll(".shows-content").forEach(c => c.classList.remove("active"));
                        tab.classList.add("active");
                        document.getElementById(tab.dataset.tab).classList.add("active");
                    });
                });
            })
            .catch(err => {
                console.error(err);
                tabShowsContents.innerHTML = `<p>Error loading data</p>`;
            });
        }

        loadShowsData("shows!A2:J");
    </script>


    <footer class="footer">
        <div class="footer-bar">
            &copy; Made with Love | By <a href="https://x.com/yorkorrrr">yorkor</a><br/>
        </div>
    </footer>

    <script>
        // ไฮไลท์เมนูขณะเลื่อน
        document.addEventListener("DOMContentLoaded", () => {
            const sections = document.querySelectorAll("section[id]");
            const navLinks = document.querySelectorAll(".nav-links li a");

            const observer = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            navLinks.forEach(link => {
                                link.classList.remove("active");
                                if (link.getAttribute("href") === `#${entry.target.id}`) {
                                    link.classList.add("active");
                                }
                            });
                        }
                    });
                },
                {
                    threshold: 0.3, // เห็น section 30% ถึงจะ active
                }
            );

            sections.forEach(section => {
                observer.observe(section);
            });
        });
    </script>

    <script src="script.js"></script>

</body>

</html>