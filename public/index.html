<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="style.css" />
    <title>pippor & 2tee</title>
    <link rel="icon" href="assets/icons/icon.png" type="image/png">
</head>

<body>

    <!-- Navbar -->
    <div class="nav">
        <nav>
            <div class="nav__logo"><span><a href="index.html">PTTP</a></span></div>

            <div class="nav__toggle" id="nav-toggle">
                <i class="ri-menu-line"></i>
            </div>

            <ul class="nav__links" id="nav-menu">
                <li class="link"><a href="#profile">Profile</a></li>
                <li class="link"><a href="#schedule">Schedule</a></li>
                <li class="link"><a href="#discography">Discography</a></li>
                <li class="link"><a href="#filmography">Filmography</a></li>
                <li class="link"><a href="#brand">Brand Presenter</a></li>
                <li class="link"><a href="#awards">Awards</a></li>
                <li class="link"><a href="#shows">Shows</a></li>
            </ul>
        </nav>
    </div>

    <!-- Profile Section -->
    <section class="profile-section" id="profile">
        <div class="profile-card">
            <div class="profile-image">
                <img src="https://pbs.twimg.com/media/GuB0uEoWMAAHVIT?format=jpg&name=large" alt="Por">
            </div>
            <div class="profile-text">
                <h1><span>Por</span></h1>
                <h2>Suppakarn Jirachotikul</h2>
                <p>
                    Rising actor-singer who debuted as a main member of DVI after competing on LAZiCON. Notable role as Punlee in Your Sky Series; upcoming as Qin in Duang With You Series.
                </p>
                <div class="social-links">
                    <a href="https://x.com/porsuppakarn" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.instagram.com/porsuppakarn" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.tiktok.com/@porsuppakarn" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="https://weibo.com/u/7910928995" target="_blank"><i class="fa-brands fa-weibo"></i></a>
                </div>
            </div>
        </div>

        <div class="profile-card">
            <div class="profile-image">
                <img src="https://pbs.twimg.com/media/Gt93Ot5WYAAMRKO?format=jpg&name=4096x4096" alt="TeeTee">
            </div>
            <div class="profile-text">
                <h1><span>TeeTee</span></h1>
                <h2>Wanpichit Nimitparkpoom</h2>
                <p>
                    New-generation actor recognized from DMD Friendship the Reality. Trained via TO BE NUMBER ONE IDOL. Appeared as Glaijai in Your Sky Series, with an upcoming lead as Duang in Duang With You Series.
                </p>
                <div class="social-links">
                    <a href="https://x.com/twnpich" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.instagram.com/twnpich/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.tiktok.com/@teetee.wpc" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="https://weibo.com/u/7978599852" target="_blank"><i class="fa-brands fa-weibo"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Schedule Section -->
    <section class="schedule" id="schedule">
        <div class="schedule__container">
            <h2 class="section__title">Schedule</h2>
            <div class="schedule__grid" id="scheduleGridUpcoming"></div>
            <div class="view-all">
                <a href="schedule.html">View All Events</a>
            </div>
        </div>
    </section>

    <script>
        function loadScheduleData(range, elementId) {
            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];
                const grid = document.getElementById(elementId);
                grid.innerHTML = rows.map(row => {
                    const [date, time, artist, title, location, info, img, link, outfit, keyword, tag, note, keylink, taglink, dateformat] = row;
                    return `
                        <div class="schedule__card">
                            <img src="${img}" alt="schedule" ${ link ? `onclick="openLink('${link}')"` : (info ? `onclick="openLink('${info}')"` : '')}/>
                            <div class="schedule__details">
                                ${title ? `<p class="schedule__title">${title}</p>` : ''}
                                
                                ${(keyword || tag) ? `
                                    <div class="keytag">
                                        ${keyword ? `<a href="${keylink}" class="schedule__tag" target="_blank" rel="noopener noreferrer">${keyword}</a>` : ''}
                                        ${tag ? `<a href="${taglink}" class="schedule__tag" target="_blank" rel="noopener noreferrer">${tag}</a>` : ''}
                                    </div>
                                ` : ''}
                                
                                <div class="datetimelocation">
                                    <div class="schedule__info">
                                        <i class="fa-solid fa-calendar-days"></i>
                                        <span>${date} ${time ? `| ${time}` : ''}</span>
                                    </div>
                                    ${location ? `
                                        <div class="schedule__info">
                                            <i class="fa-solid fa-location-dot"></i>
                                            <span>${location}</span>
                                        </div>
                                    ` : ''}
                                </div>

                                <div class="schedule__btn">
                                    ${
                                        link
                                            ? `<a href="${link}" target="_blank" class="streaming">Rerun</a>`
                                            : (info ? `<a href="${info}" target="_blank" class="streaming">info</a>` : '')
                                    }
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            });
        }

        loadScheduleData('upcoming!A2:Z', 'scheduleGridUpcoming');
    </script>

    <!-- Discography Section -->
    <section class="discography" id="discography">
        <div class="discography__container">
            <h2 class="section__title">Discography</h2>
            <div class="discography-grid" id="singleGrid"></div>
        </div>
    </section>

    <script>
        function createDiscographyCard(row) {
            const [artist2, date, song, artist, link, img, formatdate] = row;

            return `
            <div class="ent-card ${artist2}">
                <img src="${img}" alt="${song}" class="song-img" />
                <div class="ent-details">
                    <p class="ent-title">${song}</p>
                    <p class="ent-subtitle-1">${artist}</p>
                    <p class="ent-subtitle-2">${formatdate}</p>
                    <p class="play_btn" onclick="openLink('${link}')">
                        <i class="fa-solid fa-play"></i>
                    </p>
                </div>
            </div>
            `;
        }

        function loadDiscographyData(range) {
            const container = document.getElementById("singleGrid");
            container.innerHTML = `<div class="loading-spinner"></div>`;

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    container.innerHTML = "<p>no data</p>";
                    return;
                }

                container.innerHTML = rows.map(createDiscographyCard).join("");
            })
            .catch(err => {
                console.error(err);
                container.innerHTML = "<p>error fetch data</p>";
            });
        }

        // โหลดข้อมูลครั้งเดียว
        loadDiscographyData("discography!A2:Z");
    </script>

    <!-- Filmography Section -->
    <section class="film" id="filmography">
        <div class="film__container">
            <h2 class="section__title">Filmography</h2>
            <div class="film-grid" id="filmGrid"></div>
        </div>
    </section>

    <script>
        function createFilmCard(row) {
            const [type, title, role, info, link, img] = row;

            return `
            <div class="ent-card">
                <img src="${img}" alt="${title}" class="film-img" />
                <div class="ent-details">
                    <p class="ent-title">${title}</p>
                    <p class="ent-subtitle-1">${role}</p>
                    <p class="ent-subtitle-2">${info}</p>
                    <p class="play_btn" onclick="openLink('${link}')">
                        <i class="fa-solid fa-play"></i>
                    </p>
                </div>
            </div>
            `;
        }

        function loadFilmData(range) {
            const container = document.getElementById("filmGrid");
            container.innerHTML = `<div class="loading-spinner"></div>`;

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    container.innerHTML = "<p>no data</p>";
                    return;
                }

                container.innerHTML = rows.map(createFilmCard).join("");
            })
            .catch(err => {
                console.error(err);
                container.innerHTML = "<p>error fetch data</p>";
            });
        }

        // โหลดข้อมูลครั้งเดียว
        loadFilmData("film!A2:Z");
    </script>

    <!-- Brand Presenter Section -->
    <section class="brand" id="brand">
        <div class="brand__container">
            <h2 class="section__title">Brand Presenter</h2>
            <div class="brand__grid" id="presenterGrid">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </section>

    <script>
        function loadPresenterData(range, elementId) {
            const grid = document.getElementById(elementId);
            
            grid.innerHTML = '<div class="loading-spinner"></div>';

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => {
                if (!res.ok) {
                    throw new Error('Network response was not ok');
                }
                return res.json();
            })
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    grid.innerHTML = '<p>No data available</p>';
                    return;
                }

                grid.innerHTML = rows.map(row => {
                    const [artist, date, brand, link, dmd, img] = row;
                    return `
                        <div class="brand__card" onclick="openLink('${dmd}')">
                            <img src="${img}" alt="${brand}" />
                            <div class="brand__details">
                                <p class="brand__title">${brand}</p>
                                <p class="brand__subtitle">Start: ${date}</p>
                            </div>
                        </div>
                    `;
                }).join('');
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
                grid.innerHTML = '<p>Error loading data</p>';
            });
        }
        loadPresenterData('presenter!A2:Z', 'presenterGrid');
    </script>

    <!-- Awards Section -->
    <section class="awards" id="awards">
        <div class="awards__container">
            <h2 class="section__title">Awards</h2>
            <div class="awards__grid" id="awardsGrid">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </section>

    <script>
        function loadAwardsData(range, elementId) {
            const grid = document.getElementById(elementId);
            
            grid.innerHTML = '<div class="loading-spinner"></div>';

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => {
                if (!res.ok) {
                    throw new Error('Network response was not ok');
                }
                return res.json();
            })
            .then(data => {
                let rows = data.values || [];

                grid.innerHTML = rows.map(row => {
                    const [artist, date, award, category, result, link, note, img] = row;

                    let resultHTML = '';
                    if (result === 'Received') {
                        resultHTML = `<p class="awards__result received">${result}</p>`;
                    } else if (result === 'Nominated') {
                        resultHTML = `<p class="awards__result nominated">${result}</p>`;
                    } else {
                        resultHTML = `<p class="awards__result">${result}</p>`;
                    }

                    return `
                        <div class="awards__card" onclick="openLink('${link}')">
                            <img src="${img}" alt="" />
                            <div class="awards__details">
                                <p class="awards__title">${award}</p>
                                <p class="awards__subtitle">${category}</p>
                                ${resultHTML}
                            </div>
                        </div>
                    `;
                }).join('');
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
                grid.innerHTML = '<p>เกิดข้อผิดพลาดในการโหลดข้อมูล</p>';
            });
        }
        loadAwardsData('awards!A2:Z', 'awardsGrid');
    </script>

    <!-- Shows Section -->
    <section class="shows" id="shows">
        <div class="shows__container">
            <h2 class="section__title">Shows</h2>
        </div>

        <div class="tab-menu-2" id="tabMenu2"></div>
        <div class="tab-contents" id="tabContents2"></div>
    </section>

    <script>
        function createShowCard(row) {
            const [type, artist, date, title, link, id, thumbnail, channel, imgchannel, duration] = row;
            return `
            <div class="showcard" onclick="openLink('${link}')">
                <div class="thumbnail">
                    <img src="${thumbnail}" alt="video">
                    <span class="badge">${duration}</span>
                </div>
                <div class="info">
                    <img src="${imgchannel}" alt="channel">
                    <div class="text">
                        <p class="title">${title}</p>
                        <p class="channel">${channel} • ${date}</p>
                    </div>
                </div>
            </div>
            `;
        }

        function loadShowsData(range) {
            const tabMenu2 = document.getElementById("tabMenu2");
            const tabContents2 = document.getElementById("tabContents2");

            tabMenu2.innerHTML = `<div class="loading-spinner"></div>`;
            tabContents2.innerHTML = "";

            fetch(`/api/spreadsheets?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                if (rows.length === 0) {
                    tabContents2.innerHTML = `<p>No data available</p>`;
                    tabMenu2.innerHTML = "";
                    return;
                }

                const types = [...new Set(rows.map(r => r[0]))]; 

                tabMenu2.innerHTML = types.map((type, idx) => 
                    `<span class="tab-link-2 ${idx===0?'active':''}" data-tab="${type}">${type}</span>`
                ).join("");

                tabContents2.innerHTML = types.map((type, idx) => {
                    const filtered = rows.filter(r => r[0] === type);
                    return `
                        <div id="${type}" class="tab-content-2 ${idx===0?'active':''}">
                            <div class="shows__grid">
                                ${filtered.map(createShowCard).join("")}
                            </div>
                        </div>`;
                }).join("");

                document.querySelectorAll(".tab-link-2").forEach(tab => {
                    tab.addEventListener("click", () => {
                        document.querySelectorAll(".tab-link-2").forEach(t => t.classList.remove("active"));
                        document.querySelectorAll(".tab-content-2").forEach(c => c.classList.remove("active"));
                        tab.classList.add("active");
                        document.getElementById(tab.dataset.tab).classList.add("active");
                    });
                });
            })
            .catch(err => {
                console.error(err);
                tabContents2.innerHTML = `<p>Error loading data</p>`;
            });
        }

        loadShowsData("shows!A2:Z");
    </script>


    <footer class="footer">
        <div class="footer__bar">
            &copy; Made with Love | By <a href="https://x.com/yorkorrrr">yorkor</a><br/>
        </div>
    </footer>

    <script>
        // ไฮไลท์เมนูขณะเลื่อน
        document.addEventListener("DOMContentLoaded", () => {
            const sections = document.querySelectorAll("section[id]");
            const navLinks = document.querySelectorAll(".nav__links li a");

            const observer = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            navLinks.forEach(link => {
                                link.classList.remove("active");
                                if (link.getAttribute("href") === `#${entry.target.id}`) {
                                    link.classList.add("active");
                                }
                            });
                        }
                    });
                },
                {
                    threshold: 0.3, // เห็น section 30% ถึงจะ active
                }
            );

            sections.forEach(section => {
                observer.observe(section);
            });
        });
    </script>

    <script src="script.js"></script>

</body>

</html>