<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>pippor & 2tee</title>
    <link rel="icon" href="assets/icon.png" type="image/png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bai+Jamjuree:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600;1,700&display=swap');
        html { scroll-behavior: smooth; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #60a5fa; }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,4,12,0.05); }
        .text-primary-blue { color:#007bff; }
        .received { color: green; } .nominated { color: red; }

        /* popup */
        #popup, .popup { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background-color: rgba(0,0,0,0.8); justify-content:center; align-items:center; z-index:1000; }
        .popup-content { display:flex; flex-direction:column; align-items:center; justify-content:center; height:80%; max-width:90%; overflow:hidden; }
        .popup-content img { max-width:100%; max-height:100%; object-fit:contain; cursor:pointer; }
        .nav-btn { position:absolute; top:50%; transform:translateY(-50%); background-color: rgba(255,255,255,0.7); border:none; font-size:24px; color:#333; cursor:pointer; padding:10px; border-radius:50%; }
        .prev-btn { left:10px; } .next-btn { right:10px; }

        /* Calendar */
        .calendar-grid { display:grid; grid-template-columns: repeat(7,1fr); gap:4px; box-sizing:border-box; width:100%; }
        .day-cell { box-sizing:border-box; min-height:120px; transition: background-color .15s; min-width:0; }
        .day-cell:hover { background-color:#f3f4f6; }
        .event-dot { width:8px; height:8px; border-radius:50%; display:inline-block; margin-right:4px; }
        .current-month-day { background-color:#f9f9f9; }
        .loading-spinner { border:4px solid #f3f3f3; border-top:4px solid #3b82f6; border-radius:50%; width:30px; height:30px; animation:spin 1s linear infinite; margin:20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
        @media (max-width:768px) {
            .day-cell { min-height:80px; padding:4px; }
            .day-number { font-size:.875rem; }
            .event-dot { width:6px; height:6px; }
            .event-title { display:none; }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Custom colors defined for easy use
                        'primary-blue': '#3b82f6', // blue-500
                        'secondary-blue': '#bfdbfe', // blue-200
                        'accent-light': '#eff6ff', // blue-50
                        'card-bg': '#FFFFFF',
                    },
                    fontFamily: {
                        sans: ['Bai Jamjuree', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-accent-light text-gray-800">

    <nav class="fixed top-0 left-0 w-full bg-white shadow-lg z-50 transition-shadow duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo/Brand -->
                <a href="" class="flex-shrink-0 text-2xl font-bold text-primary-blue hover:text-blue-700 transition duration-150">
                    PTTP
                </a>

                <!-- Desktop Menu -->
                <div class="hidden md:flex md:space-x-4">
                    <!-- Profile -->
                    <a href="#profile" class="text-gray-600 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-sm font-medium transition duration-150">
                        <i data-lucide="user" class="inline-block w-4 h-4 mr-1"></i> Profile
                    </a>

                    <!-- Works Dropdown -->
                    <div class="relative group">
                        <button class="flex items-center text-gray-600 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-sm font-medium transition duration-150 focus:outline-none">
                            <i data-lucide="clapperboard" class="inline-block w-4 h-4 mr-1"></i> Works
                            <i data-lucide="chevron-down" class="ml-1 w-4 h-4 transition-transform duration-200 group-hover:rotate-180"></i>
                        </button>
                        <div class="absolute top-full hidden group-hover:block w-52 bg-white shadow-2xl rounded-xl ring-1 ring-black ring-opacity-5 z-20 overflow-hidden">
                            <a href="#series" class="block px-4 py-2 text-sm text-gray-700 hover:bg-accent-light hover:text-primary-blue transition duration-150">
                                <i data-lucide="monitor-play" class="inline-block w-4 h-4 mr-1"></i> Series
                            </a>
                            <a href="#music" class="block px-4 py-2 text-sm text-gray-700 hover:bg-accent-light hover:text-primary-blue transition duration-150 border-t border-gray-100">
                                <i data-lucide="music" class="inline-block w-4 h-4 mr-1"></i> Musics
                            </a>
                            <a href="#performance" class="block px-4 py-2 text-sm text-gray-700 hover:bg-accent-light hover:text-primary-blue transition duration-150 border-t border-gray-100">
                                <i data-lucide="person-standing" class="inline-block w-4 h-4 mr-1"></i> Performances
                            </a>
                            <a href="#cover" class="block px-4 py-2 text-sm text-gray-700 hover:bg-accent-light hover:text-primary-blue transition duration-150 border-t border-gray-100">
                                <i data-lucide="mic-vocal" class="inline-block w-4 h-4 mr-1"></i> Covers
                            </a>
                            <a href="#magazine" class="block px-4 py-2 text-sm text-gray-700 hover:bg-accent-light hover:text-primary-blue transition duration-150 border-t border-gray-100">
                                <i data-lucide="book-open" class="inline-block w-4 h-4 mr-1"></i> Magazines
                            </a>
                        </div>
                    </div>

                    <!-- Works Dropdown -->
                     <a href="#shows" class="text-gray-600 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-sm font-medium transition duration-150">
                        <i data-lucide="radio" class="inline-block w-4 h-4 mr-1"></i> Shows
                    </a>

                    <!-- Brand & Awards Dropdown -->
                    <div class="relative group">
                        <button class="flex items-center text-gray-600 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-sm font-medium transition duration-150 focus:outline-none">
                            <i data-lucide="star" class="inline-block w-4 h-4 mr-1"></i> Brand & Awards
                            <i data-lucide="chevron-down" class="ml-1 w-4 h-4 transition-transform duration-200 group-hover:rotate-180"></i>
                        </button>
                        <div class="absolute top-full hidden group-hover:block w-52 bg-white shadow-2xl rounded-xl ring-1 ring-black ring-opacity-5 z-20 overflow-hidden">
                            <a href="#brand-presenter" class="block px-4 py-2 text-sm text-gray-700 hover:bg-accent-light hover:text-primary-blue transition duration-150">
                                <i data-lucide="megaphone" class="inline-block w-4 h-4 mr-1"></i> Brand Presenter
                            </a>
                            <a href="#awards" class="block px-4 py-2 text-sm text-gray-700 hover:bg-accent-light hover:text-primary-blue transition duration-150 border-t border-gray-100">
                                <i data-lucide="award" class="inline-block w-4 h-4 mr-1"></i> Awards
                            </a>
                        </div>
                    </div>

                    <!-- Schedule -->
                    <a href="#schedule" class="text-gray-600 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-sm font-medium transition duration-150">
                        <i data-lucide="calendar" class="inline-block w-4 h-4 mr-1"></i> Schedule
                    </a>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-primary-blue focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-blue transition duration-150" aria-expanded="false">
                        <!-- Icon when menu is closed -->
                        <i data-lucide="menu" id="menu-icon" class="block h-6 w-6"></i>
                        <!-- Icon when menu is open (Hidden initially) -->
                        <i data-lucide="x" id="close-icon" class="hidden h-6 w-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu (Collapsed by default) -->
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#profile" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                    <i data-lucide="user" class="inline-block w-4 h-4 mr-2"></i> Profile
                </a>

                <div>
                    <button id="mobile-works-toggle" class="w-full flex justify-between items-center text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" aria-expanded="false">
                        <span><i data-lucide="clapperboard" class="inline-block w-4 h-4 mr-2"></i> Works</span>
                        <i data-lucide="chevron-down" id="mobile-works-chevron" class="w-4 h-4 transform transition-transform duration-200"></i>
                    </button>
                    <div id="mobile-works-submenu" class="pl-6 pt-1 hidden space-y-1">
                        <a href="#series" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                            <i data-lucide="monitor-play" class="inline-block w-4 h-4 mr-2"></i> Series
                        </a>
                        <a href="#music" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                            <i data-lucide="music" class="inline-block w-4 h-4 mr-2"></i> Musics
                        </a>
                        <a href="#performance" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                            <i data-lucide="person-standing" class="inline-block w-4 h-4 mr-2"></i> Performances
                        </a>
                        <a href="#cover" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                            <i data-lucide="mic-vocal" class="inline-block w-4 h-4 mr-2"></i> Covers
                        </a>
                        <a href="#magazine" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                            <i data-lucide="book-open" class="inline-block w-4 h-4 mr-2"></i> Magazines
                        </a>
                    </div>
                </div>

                <a href="#shows" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                    <i data-lucide="radio" class="inline-block w-4 h-4 mr-2"></i> Shows
                </a>

                <!-- Brand & Awards -->
                <div>
                    <button id="mobile-awards-toggle" class="w-full flex justify-between items-center text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" aria-expanded="false">
                        <span><i data-lucide="star" class="inline-block w-4 h-4 mr-2"></i> Brand & Awards</span>
                        <i data-lucide="chevron-down" id="mobile-awards-chevron" class="w-4 h-4 transform transition-transform duration-200"></i>
                    </button>
                    <div id="mobile-awards-submenu" class="pl-6 pt-1 hidden space-y-1">
                        <a href="#brand-presenter" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                            <i data-lucide="megaphone" class="inline-block w-4 h-4 mr-2"></i> Brand Presenter
                        </a>
                        <a href="#awards" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                            <i data-lucide="award" class="inline-block w-4 h-4 mr-2"></i> Awards
                        </a>
                    </div>
                </div>

                <!-- ตารางงาน -->
                <a href="#schedule" class="block text-gray-800 hover:bg-primary-blue hover:text-white px-3 py-2 rounded-lg text-base font-medium transition duration-150" onclick="closeMobileMenu()">
                    <i data-lucide="calendar" class="inline-block w-4 h-4 mr-2"></i> Schedule
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content (Padding added to offset fixed navbar) -->
    <main class="pt-16">

        <!-- หน้าประวัติส่วนตัว (Profile) -->
        <section id="profile" class="py-16 px-4 md:py-24 md:px-8 bg-white border-b-4 border-primary-blue">
            <!-- <h1 class="text-4xl sm:text-5xl font-extrabold text-primary-blue text-center mb-12">
                หน้าประวัติส่วนตัว
            </h1> -->

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-7xl mx-auto">
                
                <!-- Profile 1 -->
                <div class="text-center">
                    <div class="relative w-80 h-120 mx-auto mb-6">
                        <img src="https://pbs.twimg.com/media/GuB0uEoWMAAHVIT?format=jpg&name=large" alt="por" 
                            class="rounded-full object-cover w-full h-full border-4 border-secondary-blue shadow-xl">
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Por</h2>
                    <!-- <p class="text-gray-600 mb-6">Rising actor-singer who debuted as a main member of DVI after competing on LAZiCON. Notable role as Punlee in Your Sky Series; upcoming as Qin in Duang With You Series.</p> -->
                    <div class="bg-accent-light p-6 rounded-xl shadow-lg text-left max-w-sm mx-auto">
                        <h3 class="text-2xl font-semibold text-gray-700 mb-3">Suppakarn Jirachotikul</h3>
                        <ul class="space-y-2 text-gray-600">
                            <li><span class="font-semibold text-primary-blue">Date of Birth: </span>17 October 2002</li>
                            <li><span class="font-semibold text-primary-blue">Hashtag: </span>#porsuppakarn</li>
                            <li class="flex items-center space-x-4 social-links">
                                <a href="https://x.com/porsuppakarn" target="_blank" class="text-primary-blue hover:text-gray-800">
                                    <i class="fa-brands fa-x-twitter text-xl"></i>
                                </a>
                                <a href="https://www.instagram.com/porsuppakarn" target="_blank" class="text-primary-blue hover:text-pink-500">
                                    <i class="fa-brands fa-instagram text-xl"></i>
                                </a>
                                <a href="https://www.tiktok.com/@porsuppakarn" target="_blank" class="text-primary-blue hover:text-gray-800">
                                    <i class="fa-brands fa-tiktok text-xl"></i>
                                </a>
                                <a href="https://weibo.com/u/7910928995" target="_blank" class="text-primary-blue hover:text-red-500">
                                    <i class="fa-brands fa-weibo text-xl"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Profile 2 -->
                <div class="text-center">
                    <div class="relative w-80 h-120 mx-auto mb-6">
                        <img src="https://pbs.twimg.com/media/Gt93Ot5WYAAMRKO?format=jpg&name=4096x4096" alt="Teetee" 
                            class="rounded-full object-cover w-full h-full border-4 border-secondary-blue shadow-xl">
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">TeeTee</h2>
                    <!-- <p class="text-gray-600 mb-6">New-generation actor recognized from DMD Friendship the Reality. Trained via TO BE NUMBER ONE IDOL. Appeared as Glaijai in Your Sky Series, with an upcoming lead as Duang in Duang With You Series.</p> -->
                    <div class="bg-accent-light p-6 rounded-xl shadow-lg text-left max-w-sm mx-auto">
                        <h3 class="text-2xl font-semibold text-gray-700 mb-3">Wanpichit Nimitparkpoom</h3>
                        <ul class="space-y-2 text-gray-600">
                            <li><span class="font-semibold text-primary-blue">Date of Birth: </span>20 March 2005</li>
                            <li><span class="font-semibold text-primary-blue">Hashtag: </span>#twnpich</li>
                            <li class="flex items-center space-x-4 social-links">
                                <a href="https://x.com/twnpich" target="_blank" class="text-primary-blue hover:text-gray-800">
                                    <i class="fa-brands fa-x-twitter text-xl"></i>
                                </a>
                                <a href="https://www.instagram.com/twnpich/" target="_blank" class="text-primary-blue hover:text-pink-500">
                                    <i class="fa-brands fa-instagram text-xl"></i>
                                </a>
                                <a href="https://www.tiktok.com/@teetee.wpc" target="_blank" class="text-primary-blue hover:text-gray-800">
                                    <i class="fa-brands fa-tiktok text-xl"></i>
                                </a>
                                <a href="https://weibo.com/u/7978599852" target="_blank" class="text-primary-blue hover:text-red-500">
                                    <i class="fa-brands fa-weibo text-xl"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>
        </section>

        <!-- ซีรีส์ (Series) -->
        <section id="series" class="py-16 px-4 md:py-24 md:px-8 bg-accent-light border-b border-gray-200">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Series
                </h2>
                <div id="filmography-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
                    <p class="text-center col-span-full p-8 text-gray-600">loading data...</p>
                </div>
            </div>
        </section>
        <div id="details-modal" class="fixed inset-0 z-50 hidden opacity-0 transition-opacity duration-300 bg-black/50 flex items-center justify-center p-4" onclick="closeDetailsModal()">
            <div class="bg-card-bg w-full max-w-3xl rounded-xl shadow-2xl transform transition-all duration-300" onclick="event.stopPropagation()">
                <div class="flex justify-between items-center p-4 border-b border-gray-200">
                    <h3 id="modal-title" class="text-2xl font-bold text-gray-900">Title</h3>
                    <button onclick="closeDetailsModal()" class="text-gray-400 hover:text-gray-700 transition duration-150 p-2 rounded-full hover:bg-gray-100">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </div>
                <div class="modal-body overflow-y-auto p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div id="modal-poster-container" class="md:col-span-1">
                            <div class="relative w-full aspect-[3/4] mx-auto max-w-xs group">
                                <img id="modal-poster-slider" src="https://placehold.co/300x400/cccccc/333333?text=POSTER+N/A" alt="Film image" class="w-full h-full rounded-lg shadow-lg object-cover">
                                
                                <button id="nav-left" onclick="navigateImage(-1)" class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-2 rounded-full ml-2 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-30">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                                </button>
                                
                                <button id="nav-right" onclick="navigateImage(1)" class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-2 rounded-full mr-2 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-30">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                </button>
        
                                <div id="image-counter" class="absolute bottom-2 left-1/2 transform -translate-x-1/2 bg-black/50 text-white text-xs px-2 py-1 rounded-full"></div>
                            </div>
                        </div>
                        
                        <!-- Details -->
                        <div class="md:col-span-1 space-y-4 text-base text-gray-700">
                            <h4 class="text-xl font-semibold text-primary-blue mb-3 border-b pb-2">Work Details</h4>
                            <p id="modal-role"></p>
                            <p id="modal-date"></p>
                            <p id="modal-platform"></p>
                            <p id="modal-episodes"></p>
                        </div>
                    </div>
                </div>

                <!-- Modal Footer (Watch Now Button) -->
                <div class="p-4 border-t border-gray-200 flex justify-end">
                    <a id="modal-link" href="#" target="_blank" 
                    class="bg-primary-blue text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-secondary/90 transition duration-300 transform hover:scale-[1.02] text-center w-full md:w-auto">
                        Watch Now
                    </a>
                </div>

            </div>
        </div>

        <!-- เพลง (Music) -->
        <section id="music" class="py-16 px-4 md:py-24 md:px-8 bg-white border-b border-gray-200">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Musics
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8" id="discographyGrid">
                </div>
            </div>
        </section>

        <section id="performance" class="py-16 px-4 md:py-24 md:px-8 bg-accent-light border-b border-gray-200">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Performances
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 place-items-center" id="performanceGrid"></div>
            </div>
        </section>

        <section id="cover" class="py-16 px-4 md:py-24 md:px-8 bg-white border-b border-gray-200">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Covers
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 place-items-center" id="coverGrid"></div>
            </div>
        </section>

        <!-- นิตยสาร (Magazine) -->
        <section id="magazine" class="py-16 px-4 md:py-24 md:px-8 bg-accent-light border-b border-gray-200">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Magazines
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6" id="magazineGrid"></div>
            </div>
        </section>

        <!-- รายการ (Shows) -->
        <section id="shows" class="py-16 px-4 md:py-24 md:px-8 bg-white border-b border-gray-200">
            <div class="max-w-7xl mx-auto">

                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Shows
                </h2>

                <!-- Tab Navigation (New Feature) -->
                <div id="media-tabs" class="flex justify-center mb-8 border-b border-blue-200 space-x-4 overflow-x-auto pb-1">
                    <!-- 'All' is active by default -->
                    <!-- <button data-category="all" class="tab-button px-4 py-3 text-lg font-medium text-blue-600 border-b-4 border-blue-500 whitespace-nowrap">All</button>  -->
                    <button data-category="online" class="tab-button px-4 py-3 text-lg font-medium text-blue-600 border-b-4 border-blue-500 whitespace-nowrap">Online</button>
                    <button data-category="bts" class="tab-button px-4 py-3 text-lg font-medium text-gray-500 hover:text-blue-600 border-b-4 border-transparent whitespace-nowrap">BTS</button>
                    <button data-category="press" class="tab-button px-4 py-3 text-lg font-medium text-gray-500 hover:text-blue-600 border-b-4 border-transparent whitespace-nowrap">Press</button>
                    <button data-category="live" class="tab-button px-4 py-3 text-lg font-medium text-gray-500 hover:text-blue-600 border-b-4 border-transparent whitespace-nowrap">Live</button>
                    <button data-category="specials" class="tab-button px-4 py-3 text-lg font-medium text-gray-500 hover:text-blue-600 border-b-4 border-transparent whitespace-nowrap">Specials</button>
                </div>
                
                <div id="media-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 place-items-center">
                    <!-- Media cards will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- Brand Presenter (สินค้า/แบรนด์) -->
        <section id="brand-presenter" class="py-16 px-4 md:py-24 md:px-8 bg-accent-light border-b border-gray-200">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Brand Presenter
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-8 justify-items-center items-stretch" id="presenterGrid"></div>
            </div>
        </section>

        <!-- รางวัลที่ได้รับ (Awards) -->
        <section id="awards" class="py-16 px-4 md:py-24 md:px-8 bg-white border-b border-gray-200">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Awards
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-1 xl:grid-cols-2 gap-4" id="awardsGrid"></div>
            </div>
        </section>

        <!-- ตารางงาน (Schedule) - ใช้ Google Sheets Data -->
        <section id="schedule" class="py-16 px-4 md:py-24 md:px-8 bg-accent-light">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-blue text-center mb-12">
                    Schedule
                </h2>
                <!-- Calendar Navigation Header -->
                <div class="bg-white p-4 rounded-t-xl shadow-lg border-b border-gray-200 flex justify-between items-center sticky top-0 z-10">
                    <button onclick="changeMonth(-1)" class="p-2 rounded-full text-gray-600 hover:bg-gray-100 transition duration-150">
                        <i data-lucide="chevron-left" class="w-6 h-6"></i>
                    </button>
                    <div class="flex flex-col items-center">
                        <h3 id="currentMonthDisplay" class="text-2xl font-bold text-blue-700"></h3>
                        <button onclick="goToCurrentMonth()" class="text-xs text-gray-500 hover:text-blue-500 mt-1 transition duration-150">
                            Go to Current Month
                        </button>
                    </div>
                    <button onclick="changeMonth(1)" class="p-2 rounded-full text-gray-600 hover:bg-gray-100 transition duration-150">
                        <i data-lucide="chevron-right" class="w-6 h-6"></i>
                    </button>
                </div>

                <!-- Days of the Week Header -->
                <div class="calendar-grid p-2 bg-blue-600 text-white font-semibold text-center text-sm rounded-none">
                    <div class="py-2 min-w-0">Sun</div>
                    <div class="py-2 min-w-0">Mon</div>
                    <div class="py-2 min-w-0">Tue</div>
                    <div class="py-2 min-w-0">Wed</div>
                    <div class="py-2 min-w-0">Thu</div>
                    <div class="py-2 min-w-0">Fri</div>
                    <div class="py-2 min-w-0">Sat</div>
                </div>

                <!-- Calendar Grid (Dates) -->
                <div id="calendarGrid" class="calendar-grid bg-white p-2 rounded-b-xl shadow-xl">
                    <!-- Calendar Cells will be inserted here by JavaScript -->
                    <div class="loading-spinner col-span-7"></div>
                </div>

                <div class="text-center pt-8">
                    <p class="text-sm text-gray-500">Click on a date to view schedule details</p>
                </div>
            </div>
        </section>
        <!-- Event Detail Modal (Popup) -->
        <div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-4">
            <div class="bg-white rounded-lg max-w-xl w-full mx-auto shadow-2xl transform transition-all duration-300 scale-100">
                <div class="flex justify-between items-center p-4 border-b">
                    <h2 class="text-xl font-bold text-blue-700">Event Details</h2>
                    <button id="closeModalButton" class="text-gray-400 hover:text-gray-600 transition duration-150">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                <div class="p-6 max-h-96 overflow-y-auto">
                    <p id="eventModalDate" class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2"></p>
                    <div id="eventModalBody">
                        <!-- Event list will be inserted here -->
                    </div>
                </div>
            </div>
        </div>

        <div id="popup" class="popup" onclick="closePopup()">
			<div class="popup-content" onclick="event.stopPropagation()">
				<img id="popup-img" src="" alt="Full-size Event Image" onclick="closePopup()">
				<video id="popup-video" controls style="display: none; max-width: 100%; max-height: 100%;">
					<source id="video-source" src="" type="video/mp4">
					Your browser does not support the video tag.
				</video>
				<button class="nav-btn prev-btn" onclick="prevMedia()">❮</button>
        		<button class="nav-btn next-btn" onclick="nextMedia()">❯</button>
			</div>
		</div>

    </main>

    <footer class="bg-primary-blue text-white p-4 text-center">
        <p class="text-sm">&copy; Made with Love | By <a href="https://x.com/yorkorrrr" target="_blank">yorkor</a><br/></p>
    </footer>

    <!-- ================== Consolidated Script: fetch once -> render ================== -->
    <script>
    // ---------- Utility helpers ----------
    const byId = id => document.getElementById(id);
    const safe = v => v === undefined || v === null ? '' : v;

    function mapToObjects(rows, keys) {
        if (!Array.isArray(rows)) return [];
        return rows.map(r => {
            const obj = {};
            keys.forEach((k, i) => obj[k] = r[i] || '');
            return obj;
        }).filter(o => Object.values(o).some(v => v !== ''));
    }

    // ---------- RENDERERS (use your original templates, converted to functions) ----------
    // Series / Filmography
    function renderSeries(rows) {
        const list = byId('filmography-list');
        if (!list) return;
        const keys = ['title','role','role2','date','platform','episodes','link','link2','poster','image2','image3','image4'];
        const films = mapToObjects(rows, keys);

        if (films.length === 0) {
            list.innerHTML = '<p class="text-gray-600 text-center col-span-full p-8 bg-white rounded-xl shadow-lg">No joint filmography found.</p>';
            return;
        }

        list.innerHTML = films.map((film, index) => `
            <div class="bg-card-bg rounded-xl shadow-lg hover:shadow-2xl transition duration-300 overflow-hidden cursor-pointer" onclick="showDetailsModalFromData(${index})" data-index="${index}">
                <div class="relative">
                    <img src="${film.poster || 'https://placehold.co/600x400/cccccc/333333?text=Poster+N/A'}"
                         alt="โปสเตอร์ ${film.title}" class="w-full aspect-[4/5] object-cover"
                         onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/333333?text=Poster+N/A'">
                    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-gray-900/80 to-transparent p-4">
                        <h3 class="text-2xl font-bold text-white leading-tight">${film.title}</h3>
                    </div>
                </div>
                <div class="p-4">
                    <span class="text-lg font-semibold text-gray-800">Role: ${film.role2 || '-'}</span>
                </div>
            </div>
        `).join('');

        // store films for modal usage
        window.__seriesData = films;
    }

    // Modal helpers for Series
    let currentImageIndex = 0;
    let currentFilmImages = [];
    function showDetailsModalFromData(index) {
        const films = window.__seriesData || [];
        const film = films[index];
        const modal = byId('details-modal');
        if (!film || !modal) return;

        currentFilmImages = [];
        if (film.poster) currentFilmImages.push(film.poster);
        if (film.image2) currentFilmImages.push(film.image2);
        if (film.image3) currentFilmImages.push(film.image3);
        if (film.image4) currentFilmImages.push(film.image4);
        currentImageIndex = 0;

        byId('modal-title').textContent = film.title || '';
        byId('modal-role').innerHTML = `<strong class="text-gray-900">Role:</strong> ${film.role || '-'}`;
        byId('modal-date').innerHTML = `<strong class="text-gray-900">Air Date:</strong> ${film.date || '-'}`;
        byId('modal-platform').innerHTML = `<strong class="text-gray-900">Platform:</strong> ${film.platform || '-'}`;
        byId('modal-episodes').innerHTML = `<strong class="text-gray-900">Episodes:</strong> ${film.episodes || '-'}`;
        byId('modal-link').href = film.link || '#';

        // update carousel UI
        updateCarouselUI();

        modal.classList.remove('hidden','opacity-0');
        modal.classList.add('opacity-100');
    }
    function updateCarouselUI() {
        const imgElement = byId('modal-poster-slider');
        const counterElement = byId('image-counter');
        const navLeft = byId('nav-left');
        const navRight = byId('nav-right');
        if (!imgElement || !counterElement) return;
        if (!currentFilmImages || currentFilmImages.length === 0) {
            imgElement.src = 'https://placehold.co/300x400/cccccc/333333?text=POSTER+N/A';
            counterElement.textContent = '';
            navLeft && navLeft.classList.add('hidden');
            navRight && navRight.classList.add('hidden');
            return;
        }
        imgElement.src = currentFilmImages[currentImageIndex];
        imgElement.onerror = function(){ this.src='https://placehold.co/300x400/cccccc/333333?text=IMAGE+N/A'; };
        counterElement.textContent = `${currentImageIndex + 1} / ${currentFilmImages.length}`;
        if (navLeft && navRight) {
            navLeft.disabled = (currentImageIndex === 0);
            navRight.disabled = (currentImageIndex === currentFilmImages.length - 1);
            navLeft.classList.toggle('hidden', currentFilmImages.length <= 1);
            navRight.classList.toggle('hidden', currentFilmImages.length <= 1);
            counterElement.classList.toggle('hidden', currentFilmImages.length <= 1);
        }
    }
    function navigateImage(direction) {
        const newIndex = currentImageIndex + direction;
        if (newIndex >= 0 && newIndex < currentFilmImages.length) {
            currentImageIndex = newIndex;
            updateCarouselUI();
        }
    }
    function closeDetailsModal() {
        const modal = byId('details-modal');
        if (!modal) return;
        modal.classList.add('opacity-0');
        setTimeout(()=> modal.classList.add('hidden'), 300);
    }
    window.navigateImage = navigateImage;
    window.closeDetailsModal = closeDetailsModal;

    // Discography
    function renderDiscography(rows) {
        const container = byId('discographyGrid');
        if (!container) return;
        const keys = ['artist2','date','song','artist','link','img','formatdate'];
        const items = mapToObjects(rows, keys);
        if (items.length === 0) {
            container.innerHTML = '<p class="text-center col-span-full p-8 text-gray-600">no data</p>';
            return;
        }
        container.innerHTML = items.map(it => `
            <div class="flex items-center bg-accent-light p-4 rounded-xl shadow-md hover:bg-secondary-blue/30 transition">
                <img src="${safe(it.img)}" alt="cover" class="w-20 h-20 object-cover rounded-lg mr-4">
                <div class="flex-grow">
                    <h3 class="text-lg font-semibold text-gray-800">${safe(it.song)}</h3>
                    <p class="text-sm text-gray-600">${safe(it.artist)}</p>
                </div>
                <a href="${safe(it.link)}" target="_blank" rel="noopener noreferrer" class="text-primary-blue hover:text-blue-700">
                    <i class="fa-solid fa-circle-play fa-2x"></i>
                </a>
            </div>
        `).join('');
    }

    function renderPerformance(rows) {
        const container = byId('performanceGrid');
        if (!container) return;
        const keys = ['type', 'artist', 'date', 'song', 'artist2', 'link', 'pic', 'note', 'channel', 'imgchannel'];
        const items = mapToObjects(rows, keys);
        container.innerHTML = items.map(it => `
            <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover w-full max-w-md transition transform hover:scale-105">
                <a href="${safe(it.link)}" target="_blank" class="block">
                    <div class="relative aspect-video">
                        <img src="${safe(it.pic)}" alt="thumbnail" class="w-full h-full object-cover">
                    </div>
                    <div class="flex p-2">
                        <img src="${safe(it.imgchannel)}" alt="channel" class="w-8 h-8 rounded-full mr-2">
                        <div class="flex-1">
                            <h3 class="text-sm font-bold leading-tight hover:text-primary-blue cursor-pointer line-clamp-2">
                                ${safe(it.song)}
                            </h3>
                            <p class="text-xs text-gray-600 mt-1">${safe(it.channel)} • ${safe(it.date)}</p>
                        </div>
                    </div>
                </a>
            </div>
        `).join('');
    }
    function renderCover(rows) {
        const container = byId('coverGrid');
        if (!container) return;
        const keys = ['type', 'artist', 'date', 'song', 'artist2', 'link', 'pic', 'note', 'channel', 'imgchannel'];
        const items = mapToObjects(rows, keys);
        container.innerHTML = items.map(it => `
            <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover w-full max-w-md transition transform hover:scale-105">
                <a href="${safe(it.link)}" target="_blank" class="block">
                    <div class="relative aspect-video">
                        <img src="${safe(it.pic)}" alt="thumbnail" class="w-full h-full object-cover">
                    </div>
                    <div class="flex p-2">
                        <img src="${safe(it.imgchannel)}" alt="channel" class="w-8 h-8 rounded-full mr-2">
                        <div class="flex-1">
                            <h3 class="text-sm font-bold leading-tight hover:text-primary-blue cursor-pointer line-clamp-2">
                                ${safe(it.song)}
                            </h3>
                            <p class="text-xs text-gray-600 mt-1">${safe(it.channel)} • ${safe(it.date)}</p>
                        </div>
                    </div>
                </a>
            </div>
        `).join('');
    }

    // Magazine
    function renderMagazine(rows) {
        const container = byId('magazineGrid');
        if (!container) return;
        const keys = ['artist','date','name','pic','link','note'];
        const items = mapToObjects(rows, keys);
        container.innerHTML = items.map(it => `
            <div class="text-center" onclick="openLink('${safe(it.link)}')">
                <div class="w-full aspect-[3/4] overflow-hidden rounded-lg shadow-xl mb-3 border-2 border-primary-blue">
                    <img src="${safe(it.pic)}" alt="${safe(it.name)}" class="w-full h-full object-cover object-center transition transform hover:scale-105">
                </div>
                <p class="text-sm font-medium text-gray-700">${safe(it.name)}</p>
            </div>
        `).join('');
    }

    // Shows (tabs)
    function renderShows(rows) {
        const container = byId('media-grid');
        if (!container) return;
        const keys = ['type','artist','date','title','link','id','thumbnail','channel','imgchannel','duration'];
        const items = mapToObjects(rows, keys);
        container.innerHTML = items.map(it => `
            <div data-category="${safe(it.type).toLowerCase()}" class="media-card bg-white rounded-xl shadow-lg overflow-hidden card-hover w-full max-w-md transition transform hover:scale-105">
                <a href="${safe(it.link)}" target="_blank" class="block">
                    <div class="relative aspect-video">
                        <img src="${safe(it.thumbnail)}" alt="thumbnail" class="w-full h-full object-cover">
                        <span class="absolute bottom-2 right-2 bg-black bg-opacity-80 text-white text-xs px-1.5 py-0.5 rounded">
                            ${safe(it.duration)}
                        </span>
                    </div>
                    <div class="flex p-2">
                        <img src="${safe(it.imgchannel)}" alt="channel" class="w-8 h-8 rounded-full mr-2">
                        <div class="flex-1">
                            <h3 class="text-sm font-bold leading-tight hover:text-primary-blue cursor-pointer line-clamp-2">
                                ${safe(it.title)}
                            </h3>
                            <p class="text-xs text-gray-600 mt-1">${safe(it.channel)} • ${safe(it.date)}</p>
                        </div>
                    </div>
                </a>
            </div>
        `).join('');

        initTabs(); // re-init tabs filter after render
    }
    function initTabs() {
        const tabs = document.querySelectorAll('.tab-button');
        const mediaCards = document.querySelectorAll('.media-card');

        function filterMedia(category) {
            const showAll = category === 'all';
            mediaCards.forEach(card => {
                const cardCategory = card.getAttribute('data-category') || '';
                card.style.display = (showAll || cardCategory === category) ? 'block' : 'none';
            });
        }

        function setActiveTab(clickedTab) {
            tabs.forEach(tab => {
                tab.classList.add('text-gray-500','border-transparent');
                tab.classList.remove('text-blue-600','border-blue-500');
            });
            clickedTab.classList.remove('text-gray-500','border-transparent');
            clickedTab.classList.add('text-blue-600','border-blue-500');
        }

        tabs.forEach(tab => tab.addEventListener('click', function() {
            const category = this.getAttribute('data-category');
            filterMedia(category);
            setActiveTab(this);
        }));

        // default selection (your previous default was 'online')
        filterMedia('online');
    }

    // Presenter
    function renderPresenter(rows) {
        const container = byId('presenterGrid');
        if (!container) return;
        const keys = ['artist','date','brand','link','dmd','img'];
        const items = mapToObjects(rows, keys);
        container.innerHTML = items.map(it => `
            <div class="w-full max-w-xs p-4 bg-white rounded-xl shadow-lg text-center flex flex-col h-full card-hover">
                <div class="w-full aspect-[1/1] overflow-hidden rounded-lg mb-4" onclick="openLink('${safe(it.dmd)}')">
                    <img src="${safe(it.img)}" alt="${safe(it.brand)}" class="w-full h-full object-cover object-center transition transform hover:scale-105">
                </div>
                <h3 class="text-xl font-bold text-gray-800">${safe(it.brand)}</h3>
                <p class="text-sm text-gray-500">Start: ${safe(it.date)}</p>
            </div>
        `).join('');
    }

    // Awards
    function renderAwards(rows) {
        const container = byId('awardsGrid');
        if (!container) return;
        const keys = ['artist','date','award','category','award2','result','link','note','img','icon','resultth'];
        const items = mapToObjects(rows, keys);
        container.innerHTML = items.map(it => `
            <div class="flex flex-col md:flex-row items-start bg-accent-light p-5 rounded-xl shadow-lg card-hover">
                <div class="flex items-start w-full">
                    <i data-lucide="${safe(it.icon)}" class="w-6 h-6 text-primary-blue mr-4 mt-1 flex-shrink-0"></i>
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-gray-800" onclick="openLink('${safe(it.link)}')">${safe(it.category)}</h3>
                        <p class="${safe(it.result).toLowerCase()}">${safe(it.result)}</p>
                        <p class="text-gray-700">${safe(it.award)}</p>
                        <p class="text-sm text-gray-500 mt-1">${safe(it.award2)}</p>
                    </div>
                </div>
                <div class="mt-4 md:mt-0 md:ml-4 flex-shrink-0 w-full md:w-24 md:h-24 overflow-hidden rounded-md border">
                    <img src="${safe(it.img)}" alt="poster" class="w-full h-full object-cover" onclick="openPopup(['${safe(it.img)}'])">
                </div>
            </div>
        `).join('');
        lucide.createIcons();
    }

    // Schedule (calendar)
    let currentMonth = new Date();
    let allScheduleData = {}; // keyed by YYYY-MM-DD

    const monthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];
    const dowNames = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

    const getDayColorClass = (dow) => {
        switch (dow) {
            case 'Mon': return 'text-yellow-500';
            case 'Tue': return 'text-pink-500';
            case 'Wed': return 'text-green-500';
            case 'Thu': return 'text-orange-500';
            case 'Fri': return 'text-blue-500';
            case 'Sat': return 'text-purple-500';
            case 'Sun': return 'text-red-500';
            default: return 'text-gray-800';
        }
    };
    const getBorderColorClass = (dow) => {
        switch (dow) {
            case 'Mon': return 'border-yellow-500';
            case 'Tue': return 'border-pink-500';
            case 'Wed': return 'border-green-500';
            case 'Thu': return 'border-orange-500';
            case 'Fri': return 'border-blue-500';
            case 'Sat': return 'border-purple-500';
            case 'Sun': return 'border-red-500';
            default: return 'border-primary-blue';
        }
    };

    function formatDateKey(date) {
        const y = date.getFullYear();
        const m = String(date.getMonth()+1).padStart(2,'0');
        const d = String(date.getDate()).padStart(2,'0');
        return `${y}-${m}-${d}`;
    }
    function parseDateToKey(dateString) {
        if (!dateString) return null;
        const monthMap = { 'Jan':'01','Feb':'02','Mar':'03','Apr':'04','May':'05','Jun':'06','Jul':'07','Aug':'08','Sep':'09','Oct':'10','Nov':'11','Dec':'12' };
        const parts = dateString.trim().split(/\s+/);
        if (parts.length < 3) {
            try {
                const dt = new Date(dateString);
                if (!isNaN(dt) && dt.getFullYear() > 1900) return formatDateKey(dt);
            } catch(e){}
            return null;
        }
        const day = parts[0].padStart(2,'0');
        const monthAbbr = parts[1];
        const year = parts[2];
        const month = monthMap[monthAbbr];
        return month ? `${year}-${month}-${day}` : ( (() => { try{ const dt = new Date(dateString); return isNaN(dt)?null:formatDateKey(dt);}catch(e){return null;} })() );
    }

    function renderSchedule(rows) {
        // rows are raw arrays; map to objects with known columns as in original sheet
        const keys = ['date','time','artist','title','location','info','img','link','outfit','keyword','tag','note','keylink','taglink','dateformat','month','day','dow'];
        const items = mapToObjects(rows, keys);
        // build map by date
        allScheduleData = {};
        items.forEach(it => {
            const key = parseDateToKey(it.date);
            if (!key) return;
            if (!allScheduleData[key]) allScheduleData[key] = [];
            allScheduleData[key].push(it);
        });
        // render calendar
        renderCalendar();
    }

    function renderCalendar() {
        const year = currentMonth.getFullYear();
        const month = currentMonth.getMonth();
        byId('currentMonthDisplay') && (byId('currentMonthDisplay').textContent = `${monthNames[month]} ${year}`);
        const grid = byId('calendarGrid');
        if (!grid) return;
        grid.innerHTML = '';
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month+1, 0);
        const daysInMonth = lastDay.getDate();
        const startIndex = firstDay.getDay();

        for (let i=0;i<startIndex;i++) grid.innerHTML += `<div class="day-cell p-2 border rounded-md text-right bg-gray-100/50"></div>`;

        for (let day=1; day<=daysInMonth; day++) {
            const currentDate = new Date(year, month, day);
            const dateKey = formatDateKey(currentDate);
            const events = allScheduleData[dateKey] || [];
            const dow = dowNames[currentDate.getDay()];
            const dayColor = getDayColorClass(dow);
            const today = (new Date()).toDateString() === currentDate.toDateString();
            const todayClass = today ? 'bg-blue-100 border-2 border-blue-500' : 'bg-white border-gray-200';

            const eventContent = events.map(e => {
                const eventColor = getBorderColorClass(e.dow || dow).replace('border-','bg-') || 'bg-blue-500';
                return `<div class="mt-1 text-xs flex items-center w-full cursor-pointer group" onclick="showEventDetails('${dateKey}')">
                            <span class="event-dot ${eventColor} shadow-sm flex-shrink-0"></span>
                            <span class="event-title text-gray-700 font-medium truncate min-w-0 leading-tight">${safe(e.title)}</span>
                        </div>`;
            }).join('');

            grid.innerHTML += `
                <div id="day-${dateKey}" class="day-cell p-2 border rounded-md text-right current-month-day ${todayClass} cursor-pointer hover:bg-gray-50 transition duration-150"
                     onclick="showEventDetails('${dateKey}')">
                    <div class="day-number text-lg font-bold ${dayColor} mb-1">${day}</div>
                    <div class="event-list text-left space-y-0.5 overflow-hidden">${eventContent}</div>
                </div>
            `;
        }

        const totalCells = startIndex + daysInMonth;
        const remaining = 42 - totalCells;
        for (let i=0;i<remaining && totalCells+i < 42; i++) grid.innerHTML += `<div class="day-cell p-2 border rounded-md text-right bg-gray-100/50"></div>`;
    }

    function changeMonth(delta) {
        currentMonth.setMonth(currentMonth.getMonth() + delta);
        renderCalendar();
    }
    function goToCurrentMonth() {
        currentMonth = new Date();
        currentMonth.setDate(1);
        renderCalendar();
    }

    // Event modal details
    function showEventDetails(dateKey) {
        const events = allScheduleData[dateKey] || [];
        const modalBody = byId('eventModalBody');
        const modalDate = byId('eventModalDate');
        const modal = byId('eventModal');
        if (!modal || !modalBody) return;
        modalDate && (modalDate.textContent = dateKey);
        if (events.length === 0) {
            modalBody.innerHTML = '<p class="text-gray-500">No schedule found for this date.</p>';
            modal.classList.remove('hidden');
            return;
        }
        modalBody.innerHTML = events.map(event => {
            const getDayColor = getDayColorClass(event.dow || 'Fri');
            const borderColor = getBorderColorClass(event.dow || 'Fri');
            const artistImages = { "Por":"https://pbs.twimg.com/media/GuB0uEoWMAAHVIT?format=jpg&name=large", "TeeTee":"https://pbs.twimg.com/media/Gt93Ot5WYAAMRKO?format=jpg&name=4096x4096", "DEXX":"https://pbs.twimg.com/media/G2veDg5bcAAwDpN?format=jpg&name=large" };
            const parseArtists = (name) => { if (name === "PTTP") return ["TeeTee","Por"]; return [name]; };
            const artistHTML = parseArtists(event.artist).map(a => `
                <div class="flex items-center bg-gray-100 rounded-full px-3 py-1 shadow-sm">
                    <img src="${artistImages[a] || 'https://placehold.co/64x64'}" alt="${a}" class="w-6 h-6 rounded-full object-cover mr-2">
                    <span class="text-gray-800 font-semibold text-sm">${a}</span>
                </div>`).join('');

            const noteMap = {
                "งานปิดงดติดตาม": "Follow is not allowed",
                "มีรวมพลหลังเลิกงาน": "Fans gathering after the event",
                "สามารถไปให้กำลังใจรอบ ๆ งานได้": "All the fans can join in the surrounding area",
                "แฟนคลับสามารถไปร่วมกิจกรรมได้": "All the fans can joint the event",
                "เฉพาะผู้มีสิทธิ์เข้าร่วมงาน": "Private Event",
                "รับของขวัญ": "Can receive gifts"
            };
            let noteText = "";
            if (event.note) {
                const notes = event.note.split("/").map(n=>n.trim()).filter(n=>n.length>0).map(n => noteMap[n] || n);
                noteText = notes.join("/ ");
            }

            return `<div class="p-4 mb-4 border-l-4 rounded-lg shadow-md ${borderColor} bg-white">
                        <a href="${safe(event.info)}" target="_blank" rel="noopener noreferrer"><h3 class="text-xl font-bold text-gray-900">${safe(event.title)}</h3></a>
                        ${event.tag ? `<div class="mt-1 mb-2 text-xs flex flex-col md:flex-row md:space-x-2 space-y-2 md:space-y-0">
                            ${event.keyword ? `<span class="bg-blue-200 text-blue-800 px-2 py-0.5 rounded-full font-medium w-fit"><a href="${safe(event.keylink)}" target="_blank">${safe(event.keyword)}</a></span>` : ''}
                            ${event.tag ? `<span class="bg-blue-200 text-blue-800 px-2 py-0.5 rounded-full font-medium w-fit"><a href="${safe(event.taglink)}" target="_blank">${safe(event.tag)}</a></span>` : ''}
                        </div>` : ''}
                        <div class="mt-2 text-xs flex flex-wrap gap-2">${artistHTML}</div>
                        <p class="mt-2 text-sm text-gray-700"><i class="fa-solid fa-clock w-4 mr-1 ${getDayColor}"></i> ${safe(event.time) || '-'}</p>
                        <p class="mt-1 text-sm text-gray-700"><i class="fa-solid fa-location-dot w-4 mr-1 ${getDayColor}"></i> ${safe(event.location) || '-'}</p>
                        ${noteText ? `<p class="mt-1 text-sm text-gray-700"><i class="fa-solid fa-bullhorn w-4 mr-1 ${getDayColor}"></i> ${noteText}</p>` : ''}
                        ${event.link ? `<div class="mt-3"><span class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-full text-xs inline-flex items-center transition duration-150"><i class="fa-brands fa-youtube mr-1"></i><a href="${safe(event.link)}" target="_blank" rel="noopener noreferrer">Watch Video</a><i class="fa-solid fa-arrow-up-right-from-square ml-1"></i></span></div>` : ''}
                    </div>`;
        }).join('');
        modal.classList.remove('hidden');
    }
    function closeModal() {
        const modal = byId('eventModal');
        modal && modal.classList.add('hidden');
    }
    window.showEventDetails = showEventDetails;
    window.closeModal = closeModal;

    // Popup image/video viewer
    let popupIndex = 0;
    let popupItems = [];
    function openPopup(items, start=0) {
        popupItems = items || [];
        popupIndex = start || 0;
        const popup = byId('popup');
        if (!popup) return;
        const img = byId('popup-img');
        const video = byId('popup-video');
        const source = byId('video-source');

        const current = popupItems[popupIndex] || '';
        if (current.match(/\.(mp4|webm|ogg)$/i)) {
            img.style.display = 'none';
            video.style.display = 'block';
            source.src = current;
            video.load();
        } else {
            video.style.display = 'none';
            img.style.display = 'block';
            img.src = current;
        }
        popup.style.display = 'flex';
    }
    function closePopup() {
        const popup = byId('popup');
        if (!popup) return;
        const video = byId('popup-video');
        if (video) { video.pause(); video.currentTime = 0; }
        popup.style.display = 'none';
    }
    function prevMedia() {
        if (!popupItems.length) return;
        popupIndex = (popupIndex - 1 + popupItems.length) % popupItems.length;
        openPopup(popupItems, popupIndex);
    }
    function nextMedia() {
        if (!popupItems.length) return;
        popupIndex = (popupIndex + 1) % popupItems.length;
        openPopup(popupItems, popupIndex);
    }
    window.openPopup = openPopup;
    window.closePopup = closePopup;
    window.prevMedia = prevMedia;
    window.nextMedia = nextMedia;

    // Utility to open external links
    function openLink(url) { if (!url) return; window.open(url, '_blank'); }
    window.openLink = openLink;

    // ---------- MAIN: fetch once and render ----------
    async function loadAllData() {
        try {
            // show small loading indicators where appropriate
            const filmContainer = byId('filmography-list');
            if (filmContainer) filmContainer.innerHTML = '<p class="text-center col-span-full p-8 text-gray-600">Loading filmography data...</p>';
            const disc = byId('discographyGrid'); if (disc) disc.innerHTML = `<p class="text-center col-span-full p-8 text-gray-600">loading data...</p>`;
            const perf = byId('performanceGrid'); if (perf) perf.innerHTML = `<p class="text-center col-span-full p-8 text-gray-600">loading data...</p>`;
            const cov = byId('coverGrid'); if (cov) cov.innerHTML = `<p class="text-center col-span-full p-8 text-gray-600">loading data...</p>`;
            const mag = byId('magazineGrid'); if (mag) mag.innerHTML = `<p class="text-center col-span-full p-8 text-gray-600">loading data...</p>`;
            const shows = byId('media-grid'); if (shows) shows.innerHTML = `<p class="text-center col-span-full p-8 text-gray-600">loading data...</p>`;
            const prs = byId('presenterGrid'); if (prs) prs.innerHTML = `<p class="text-center col-span-full p-8 text-gray-600">loading data...</p>`;
            const aws = byId('awardsGrid'); if (aws) aws.innerHTML = `<p class="text-center col-span-full p-8 text-gray-600">loading data...</p>`;
            const cal = byId('calendarGrid'); if (cal) cal.innerHTML = `<div class="loading-spinner col-span-7"></div>`;

            const res = await fetch('/api/all-data');
            if (!res.ok) throw new Error('Failed to fetch /api/all-data');
            const json = await res.json();

            // call individual renderers
            renderSeries(json.series || []);
            renderDiscography(json.discography || []);
            renderPerformance(json.performance || []);
            renderCover(json.cover || []);
            renderMagazine(json.magazine || []);
            renderShows(json.shows || []);
            renderPresenter(json.presenter || []);
            renderAwards(json.awards || []);
            renderSchedule(json.schedule || []);

            // setup icons & misc
            lucide.createIcons();
            // ensure calendar listeners
            document.addEventListener('click', (e) => {
                const popup = byId('popup');
                if (e.target.id === 'popup') closePopup();
            });
            const closeModalBtn = byId('closeModalButton');
            closeModalBtn && closeModalBtn.addEventListener('click', closeModal);

        } catch (err) {
            console.error('loadAllData error', err);
            // show friendly error
            const all = document.querySelectorAll('[id$="Grid"], #filmography-list, #calendarGrid');
            all && all.forEach(el => el && (el.innerHTML = '<p class="text-red-600 p-4">ไม่สามารถโหลดข้อมูลได้ โปรดตรวจสอบการตั้งค่า API</p>'));
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        currentMonth.setDate(1);
        loadAllData();
    });

    </script>
    <!-- ================== END consolidated script ================== -->

    <!-- If you had additional external scripts, keep them after this point -->
     <script>
        function replaceIcons() {
            lucide.createIcons();
        }

        document.addEventListener('DOMContentLoaded', () => {
            replaceIcons();

            // ซ่อนเมนูย่อยทั้งหมดก่อน
            document.querySelectorAll('[id$="-submenu"]').forEach(submenu => submenu.classList.add('hidden'));
            document.querySelectorAll('[id$="-chevron"]').forEach(chevron => chevron.classList.remove('rotate-180'));
            
            const button = document.getElementById('mobile-menu-button');
            const menu = document.getElementById('mobile-menu');
            const menuIcon = document.getElementById('menu-icon');
            const closeIcon = document.getElementById('close-icon');

            button.addEventListener('click', () => {
                const isExpanded = menu.classList.contains('hidden');
                menu.classList.toggle('hidden');
                
                if (isExpanded) {
                    menuIcon.classList.add('hidden');
                    closeIcon.classList.remove('hidden');
                    button.setAttribute('aria-expanded', 'true');
                } else {
                    menuIcon.classList.remove('hidden');
                    closeIcon.classList.add('hidden');
                    button.setAttribute('aria-expanded', 'false');
                }
            });
            
            document.querySelectorAll('button[id$="-toggle"]').forEach(button => {
                const submenuId = button.id.replace('-toggle', '-submenu');
                const chevronId = button.id.replace('-toggle', '-chevron');
                const submenu = document.getElementById(submenuId);
                const chevron = document.getElementById(chevronId);
                
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const isExpanded = submenu.classList.contains('hidden');
                    
                    submenu.classList.toggle('hidden');
                    
                    if (isExpanded) {
                        button.setAttribute('aria-expanded', 'true');
                        chevron.classList.add('rotate-180');
                    } else {
                        button.setAttribute('aria-expanded', 'false');
                        chevron.classList.remove('rotate-180');
                    }
                });
            });
        });

        // Function ปิดเมนูมือถือเมื่อคลิกลิงก์
        function closeMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const menuIcon = document.getElementById('menu-icon');
            const closeIcon = document.getElementById('close-icon');
            const button = document.getElementById('mobile-menu-button');

            menu.classList.add('hidden');
            menuIcon.classList.remove('hidden');
            closeIcon.classList.add('hidden');
            button.setAttribute('aria-expanded', 'false');
        }
     </script>
</body>
</html>
